2025-11-10 22:56:41,808Z - INFO - ==== TE V5 Trainer start ====
2025-11-10 22:56:41,809Z - INFO - Connecting DB...
2025-11-10 22:56:41,863Z - INFO - DB OK
2025-11-10 22:56:41,863Z - INFO - Loading prices...
2025-11-10 22:58:26,708Z - INFO - Indicators (RSI/SMA/ATR)...
2025-11-10 22:58:30,139Z - INFO - Daily trends (SMA/trend)...
2025-11-10 22:58:31,677Z - INFO - Loading TE news...
2025-11-10 22:58:32,179Z - INFO - Filtered news piles >20: 9449 removed
2025-11-10 22:58:32,179Z - INFO - Loading imp_cache_tradingeconomics...
2025-11-10 22:58:32,193Z - INFO - Building targets (direction/magnitude) with +15m horizon...
2025-11-10 22:58:34,108Z - INFO - Dynamic horizon filter: 1329 -> 870 events (removed 459 with horizon < 5m)
2025-11-10 22:58:34,587Z - INFO - Direction classification thresholds: min=1.2, coeff=0.4
2025-11-10 22:58:34,588Z - INFO - Threshold range: [1.20, 1.36] pips, median=1.20
2025-11-10 22:58:34,588Z - INFO - Building features...
2025-11-10 22:58:34,598Z - INFO - Loading correlation features...
2025-11-10 22:58:34,604Z - INFO - Falling back to correlation_trends (currency/year).
2025-11-10 22:58:34,628Z - INFO - Applied currency/year correlation fallback.
2025-11-10 22:58:35,563Z - INFO - Time split @ 2025-11-06 20:30:11.200000+00:00: train=696, test=174
2025-11-10 22:58:35,563Z - INFO - Class balance (train): Counter({np.int64(2): 320, np.int64(1): 218, np.int64(0): 158})
2025-11-10 22:58:35,563Z - INFO - Class balance (test): Counter({np.int64(1): 90, np.int64(2): 54, np.int64(0): 30})
2025-11-10 22:58:35,564Z - INFO - Baseline (majority=2) acc=0.3103
2025-11-10 22:58:35,564Z - INFO - Train RandomForest (direction)...
2025-11-10 22:58:37,013Z - INFO - GridSearch XGBClassifier (direction)...
2025-11-10 22:58:47,010Z - INFO - Best XGB params: {'learning_rate': 0.05, 'max_depth': 4, 'n_estimators': 300}
2025-11-10 22:58:47,131Z - INFO - 
Confusion matrix [rows=true (0,1,2), cols=pred]:
[[24  5  1]
 [36 53  1]
 [12  0 42]]
2025-11-10 22:58:47,140Z - INFO - 
              precision    recall  f1-score   support

           0      0.333     0.800     0.471        30
           1      0.914     0.589     0.716        90
           2      0.955     0.778     0.857        54

    accuracy                          0.684       174
   macro avg      0.734     0.722     0.681       174
weighted avg      0.826     0.684     0.718       174

2025-11-10 22:58:47,142Z - INFO - Ensemble (RF+XGB) direction: acc=0.6839 f1=0.6813
2025-11-10 22:58:47,142Z - INFO - 
=== Confidence-based filtering ===
2025-11-10 22:58:47,145Z - INFO - Conf>=0.50: coverage=74.14% n=129 acc=0.690 f1=0.690
2025-11-10 22:58:47,147Z - INFO - Conf>=0.55: coverage=59.77% n=104 acc=0.702 f1=0.686
2025-11-10 22:58:47,150Z - INFO - Conf>=0.60: coverage=47.70% n= 83 acc=0.699 f1=0.664
2025-11-10 22:58:47,152Z - INFO - Conf>=0.65: coverage=41.95% n= 73 acc=0.671 f1=0.653
2025-11-10 22:58:47,154Z - INFO - Conf>=0.70: coverage=29.89% n= 52 acc=0.654 f1=0.668
2025-11-10 22:58:47,157Z - INFO - Conf>=0.75: coverage=22.41% n= 39 acc=0.538 f1=0.509
2025-11-10 22:58:47,157Z - INFO - 
=== Performance by event type (top 10) ===
2025-11-10 22:58:47,282Z - INFO - 
Top 10 best performing events:
2025-11-10 22:58:47,284Z - INFO -   te_misc_currency: acc=0.800 (4/5) avg_delta=-0.36 avg_mag=0.36
2025-11-10 22:58:47,284Z - INFO -   te_stock_market_canada: acc=0.667 (2/3) avg_delta=-4.43 avg_mag=5.37
2025-11-10 22:58:47,284Z - INFO -   te_stock_market_united_kingdom: acc=0.667 (2/3) avg_delta=+1.23 avg_mag=1.23
2025-11-10 22:58:47,285Z - INFO -   te_stock_market_china: acc=0.667 (2/3) avg_delta=+0.00 avg_mag=0.00
2025-11-10 22:58:47,285Z - INFO -   te_stock_market_hong_kong: acc=0.667 (2/3) avg_delta=+0.00 avg_mag=0.00
2025-11-10 22:58:47,285Z - INFO -   te_stock_market_germany: acc=0.667 (2/3) avg_delta=+0.93 avg_mag=0.93
2025-11-10 22:58:47,286Z - INFO -   te_misc_commodity: acc=0.500 (10/20) avg_delta=-1.08 avg_mag=1.71
2025-11-10 22:58:47,286Z - INFO -   te_stock_market_euro_area: acc=0.333 (1/3) avg_delta=-0.13 avg_mag=0.13
2025-11-10 22:58:47,286Z - INFO -   te_stock_market_france: acc=0.333 (1/3) avg_delta=+0.93 avg_mag=0.93
2025-11-10 22:58:47,287Z - INFO -   te_stock_market_italy: acc=0.333 (1/3) avg_delta=+2.00 avg_mag=2.00
2025-11-10 22:58:47,287Z - INFO - 
Bottom 10 worst performing events:
2025-11-10 22:58:47,287Z - INFO -   te_misc_currency: acc=0.800 (4/5) avg_delta=-0.36 avg_mag=0.36
2025-11-10 22:58:47,287Z - INFO -   te_stock_market_canada: acc=0.667 (2/3) avg_delta=-4.43 avg_mag=5.37
2025-11-10 22:58:47,287Z - INFO -   te_stock_market_united_kingdom: acc=0.667 (2/3) avg_delta=+1.23 avg_mag=1.23
2025-11-10 22:58:47,288Z - INFO -   te_stock_market_china: acc=0.667 (2/3) avg_delta=+0.00 avg_mag=0.00
2025-11-10 22:58:47,288Z - INFO -   te_stock_market_hong_kong: acc=0.667 (2/3) avg_delta=+0.00 avg_mag=0.00
2025-11-10 22:58:47,288Z - INFO -   te_stock_market_germany: acc=0.667 (2/3) avg_delta=+0.93 avg_mag=0.93
2025-11-10 22:58:47,288Z - INFO -   te_misc_commodity: acc=0.500 (10/20) avg_delta=-1.08 avg_mag=1.71
2025-11-10 22:58:47,288Z - INFO -   te_stock_market_euro_area: acc=0.333 (1/3) avg_delta=-0.13 avg_mag=0.13
2025-11-10 22:58:47,288Z - INFO -   te_stock_market_france: acc=0.333 (1/3) avg_delta=+0.93 avg_mag=0.93
2025-11-10 22:58:47,288Z - INFO -   te_stock_market_italy: acc=0.333 (1/3) avg_delta=+2.00 avg_mag=2.00
2025-11-10 22:58:47,443Z - INFO - GridSearch XGBRegressor (magnitude)...
2025-11-10 22:58:49,476Z - INFO - Best XGBReg params: {'learning_rate': 0.05, 'max_depth': 6, 'n_estimators': 200}
2025-11-10 22:58:49,483Z - INFO - RMSE magnitude (pips) @+15m: 1.9606
2025-11-10 22:58:49,487Z - INFO - ==== TE V5 Trainer done ====
