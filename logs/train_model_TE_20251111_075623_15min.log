2025-11-11 09:56:23,568Z - INFO - ==== TE V5 Trainer start ====
2025-11-11 09:56:23,568Z - INFO - Connecting DB...
2025-11-11 09:56:23,629Z - INFO - DB OK
2025-11-11 09:56:23,629Z - INFO - Loading prices...
2025-11-11 09:58:17,991Z - INFO - Indicators (RSI/SMA/ATR)...
2025-11-11 09:58:21,838Z - INFO - Daily trends (SMA/trend)...
2025-11-11 09:58:23,390Z - INFO - Loading TE news...
2025-11-11 09:58:23,583Z - INFO - Filtered news piles >20: 9449 removed
2025-11-11 09:58:23,583Z - INFO - Loading imp_cache_tradingeconomics...
2025-11-11 09:58:23,812Z - INFO - Building targets (direction/magnitude) with +15m horizon...
2025-11-11 09:58:25,921Z - INFO - Dynamic horizon filter: 1403 -> 739 events (removed 664 with horizon < 5m)
2025-11-11 09:58:26,448Z - INFO - Direction classification thresholds: min=1.2, coeff=0.4
2025-11-11 09:58:26,449Z - INFO - Threshold range: [1.20, 1.36] pips, median=1.20
2025-11-11 09:58:26,449Z - INFO - Building features...
2025-11-11 09:58:26,459Z - INFO - Loading correlation features...
2025-11-11 09:58:28,419Z - INFO - Falling back to correlation_trends (currency/year).
2025-11-11 09:58:30,201Z - INFO - Applied currency/year correlation fallback.
2025-11-11 09:58:31,137Z - WARNING - Constant/near-constant features: ['imp_year_trend', 'price_change', 'corr_direction', 'probability', 'observations']
2025-11-11 09:58:31,201Z - INFO - Time split @ 2025-11-10 08:33:13+00:00: train=590, test=149
2025-11-11 09:58:31,202Z - INFO - Class balance (train): Counter({np.int64(1): 283, np.int64(2): 172, np.int64(0): 135})
2025-11-11 09:58:31,202Z - INFO - Class balance (test): Counter({np.int64(0): 53, np.int64(1): 50, np.int64(2): 46})
2025-11-11 09:58:31,203Z - INFO - Baseline (majority=1) acc=0.3356
2025-11-11 09:58:31,203Z - INFO - Train RandomForest (direction)...
2025-11-11 09:58:32,600Z - INFO - GridSearch XGBClassifier (direction)...
2025-11-11 09:59:38,075Z - INFO - Best XGB params: {'colsample_bytree': 0.7, 'learning_rate': 0.03, 'max_depth': 6, 'n_estimators': 200, 'subsample': 1.0}
2025-11-11 09:59:38,191Z - INFO - 
Confusion matrix [rows=true (0,1,2), cols=pred]:
[[ 0 53  0]
 [ 4 46  0]
 [ 3 43  0]]
2025-11-11 09:59:38,200Z - INFO - 
              precision    recall  f1-score   support

           0      0.000     0.000     0.000        53
           1      0.324     0.920     0.479        50
           2      0.000     0.000     0.000        46

    accuracy                          0.309       149
   macro avg      0.108     0.307     0.160       149
weighted avg      0.109     0.309     0.161       149

2025-11-11 09:59:38,203Z - INFO - Ensemble (RF+XGB) direction: acc=0.3087 f1=0.1597
2025-11-11 09:59:38,203Z - INFO - 
=== Confidence-based filtering ===
2025-11-11 09:59:38,206Z - INFO - Conf>=0.50: coverage=90.60% n=135 acc=0.319 f1=0.163
2025-11-11 09:59:38,208Z - INFO - Conf>=0.55: coverage=81.88% n=122 acc=0.320 f1=0.164
2025-11-11 09:59:38,211Z - INFO - Conf>=0.60: coverage=74.50% n=111 acc=0.342 f1=0.170
2025-11-11 09:59:38,213Z - INFO - Conf>=0.65: coverage=66.44% n= 99 acc=0.354 f1=0.174
2025-11-11 09:59:38,216Z - INFO - Conf>=0.70: coverage=57.72% n= 86 acc=0.360 f1=0.177
2025-11-11 09:59:38,219Z - INFO - Conf>=0.75: coverage=48.99% n= 73 acc=0.384 f1=0.185
2025-11-11 09:59:38,221Z - INFO - Class-thresholds {0: 0.55, 1: 0.62, 2: 0.55}: coverage=72.48% n=108 acc=0.343 f1=0.172
2025-11-11 09:59:38,224Z - INFO - Class-thresholds {0: 0.6, 1: 0.64, 2: 0.58}: coverage=67.11% n=100 acc=0.350 f1=0.173
2025-11-11 09:59:38,224Z - INFO - 
=== Performance by event type (top 10) ===
2025-11-11 09:59:38,234Z - INFO - 
Top 10 best performing events:
2025-11-11 09:59:38,234Z - INFO -   te_stock_market_france: acc=0.667 (2/3) avg_delta=+2.17 avg_mag=2.63
2025-11-11 09:59:38,234Z - INFO -   te_misc_commodity: acc=0.538 (14/26) avg_delta=-1.40 avg_mag=2.31
2025-11-11 09:59:38,235Z - INFO -   te_stock_market_united_states: acc=0.500 (2/4) avg_delta=-1.80 avg_mag=1.80
2025-11-11 09:59:38,235Z - INFO -   te_stock_market_united_kingdom: acc=0.500 (2/4) avg_delta=+0.28 avg_mag=1.02
2025-11-11 09:59:38,235Z - INFO -   te_misc_currency: acc=0.400 (2/5) avg_delta=-0.20 avg_mag=1.52
2025-11-11 09:59:38,235Z - INFO -   te_stock_market_italy: acc=0.333 (1/3) avg_delta=-0.20 avg_mag=2.33
2025-11-11 09:59:38,235Z - INFO -   te_stock_market_japan: acc=0.000 (0/3) avg_delta=-4.73 avg_mag=4.73
2025-11-11 09:59:38,235Z - INFO - 
Bottom 10 worst performing events:
2025-11-11 09:59:38,236Z - INFO -   te_stock_market_france: acc=0.667 (2/3) avg_delta=+2.17 avg_mag=2.63
2025-11-11 09:59:38,236Z - INFO -   te_misc_commodity: acc=0.538 (14/26) avg_delta=-1.40 avg_mag=2.31
2025-11-11 09:59:38,236Z - INFO -   te_stock_market_united_states: acc=0.500 (2/4) avg_delta=-1.80 avg_mag=1.80
2025-11-11 09:59:38,236Z - INFO -   te_stock_market_united_kingdom: acc=0.500 (2/4) avg_delta=+0.28 avg_mag=1.02
2025-11-11 09:59:38,236Z - INFO -   te_misc_currency: acc=0.400 (2/5) avg_delta=-0.20 avg_mag=1.52
2025-11-11 09:59:38,237Z - INFO -   te_stock_market_italy: acc=0.333 (1/3) avg_delta=-0.20 avg_mag=2.33
2025-11-11 09:59:38,237Z - INFO -   te_stock_market_japan: acc=0.000 (0/3) avg_delta=-4.73 avg_mag=4.73
2025-11-11 09:59:38,376Z - INFO - GridSearch XGBRegressor (magnitude)...
2025-11-11 09:59:40,583Z - INFO - Best XGBReg params: {'learning_rate': 0.05, 'max_depth': 4, 'n_estimators': 400}
2025-11-11 09:59:40,588Z - INFO - RMSE magnitude (pips) @+15m: 4.4244
2025-11-11 09:59:40,596Z - INFO - ==== TE V5 Trainer done ====
