2025-11-11 12:03:00,121Z - INFO - ==== TE V5 Trainer start ====
2025-11-11 12:03:00,121Z - INFO - Connecting DB...
2025-11-11 12:03:00,186Z - INFO - DB OK
2025-11-11 12:03:00,186Z - INFO - Loading prices...
2025-11-11 12:05:09,706Z - INFO - Indicators (RSI/SMA/ATR)...
2025-11-11 12:05:14,074Z - INFO - Daily trends (SMA/trend)...
2025-11-11 12:05:16,221Z - INFO - Loading TE news...
2025-11-11 12:05:17,108Z - INFO - Filtered news piles >20: 9449 removed
2025-11-11 12:05:17,108Z - INFO - Loading imp_cache_tradingeconomics...
2025-11-11 12:05:17,816Z - INFO - Building targets (direction/magnitude) with +15m horizon...
2025-11-11 12:05:19,968Z - INFO - Dynamic horizon filter: 1429 -> 972 events (removed 457 with horizon < 5m)
2025-11-11 12:05:20,506Z - INFO - Direction classification thresholds: min=1.2, coeff=0.4
2025-11-11 12:05:20,506Z - INFO - Threshold range: [1.20, 1.36] pips, median=1.20
2025-11-11 12:05:20,506Z - INFO - Building features...
2025-11-11 12:05:20,517Z - INFO - Loading correlation features...
2025-11-11 12:05:20,847Z - INFO - Falling back to correlation_trends (currency/year).
2025-11-11 12:05:20,877Z - INFO - Applied currency/year correlation fallback.
2025-11-11 12:05:21,908Z - INFO - Time split @ 2025-11-10 07:10:00+00:00: train=777, test=195
2025-11-11 12:05:21,909Z - INFO - Class balance (train): Counter({np.int64(2): 353, np.int64(1): 261, np.int64(0): 163})
2025-11-11 12:05:21,909Z - INFO - Class balance (test): Counter({np.int64(1): 84, np.int64(0): 73, np.int64(2): 38})
2025-11-11 12:05:21,910Z - INFO - Baseline (majority=2) acc=0.1949
2025-11-11 12:05:21,910Z - INFO - Train RandomForest (direction)...
2025-11-11 12:05:23,194Z - INFO - GridSearch XGBClassifier (direction)...
2025-11-11 12:06:30,838Z - INFO - Best XGB params: {'learning_rate': 0.1, 'max_depth': 4, 'n_estimators': 300}
2025-11-11 12:06:31,062Z - INFO - 
Confusion matrix [rows=true (0,1,2), cols=pred]:
[[43 30  0]
 [20 64  0]
 [19 19  0]]
2025-11-11 12:06:31,074Z - INFO - 
              precision    recall  f1-score   support

           0      0.524     0.589     0.555        73
           1      0.566     0.762     0.650        84
           2      0.000     0.000     0.000        38

    accuracy                          0.549       195
   macro avg      0.364     0.450     0.402       195
weighted avg      0.440     0.549     0.488       195

2025-11-11 12:06:31,077Z - INFO - Ensemble (RF+XGB) direction: acc=0.5487 f1=0.4015
2025-11-11 12:06:31,077Z - INFO - 
=== Confidence-based filtering ===
2025-11-11 12:06:31,080Z - INFO - Conf>=0.50: coverage=91.28% n=178 acc=0.573 f1=0.418
2025-11-11 12:06:31,083Z - INFO - Conf>=0.55: coverage=80.00% n=156 acc=0.615 f1=0.437
2025-11-11 12:06:31,086Z - INFO - Conf>=0.60: coverage=66.15% n=129 acc=0.643 f1=0.448
2025-11-11 12:06:31,088Z - INFO - Conf>=0.65: coverage=48.72% n= 95 acc=0.705 f1=0.466
2025-11-11 12:06:31,091Z - INFO - Conf>=0.70: coverage=32.31% n= 63 acc=0.762 f1=0.288
2025-11-11 12:06:31,094Z - INFO - Conf>=0.75: coverage=23.59% n= 46 acc=0.848 f1=0.306
2025-11-11 12:06:31,094Z - INFO - 
=== Performance by event type (top 10) ===
2025-11-11 12:06:31,107Z - INFO - 
Top 10 best performing events:
2025-11-11 12:06:31,108Z - INFO -   te_stock_market_euro_area: acc=1.000 (4/4) avg_delta=-4.62 avg_mag=4.62
2025-11-11 12:06:31,108Z - INFO -   te_stock_market_japan: acc=1.000 (3/3) avg_delta=-4.73 avg_mag=4.73
2025-11-11 12:06:31,108Z - INFO -   te_stock_market_hong_kong: acc=1.000 (3/3) avg_delta=-2.50 avg_mag=2.50
2025-11-11 12:06:31,108Z - INFO -   te_stock_market_france: acc=0.800 (4/5) avg_delta=+1.26 avg_mag=1.62
2025-11-11 12:06:31,109Z - INFO -   te_stock_market_united_states: acc=0.750 (3/4) avg_delta=-1.80 avg_mag=1.80
2025-11-11 12:06:31,109Z - INFO -   te_stock_market_germany: acc=0.750 (3/4) avg_delta=+0.82 avg_mag=2.77
2025-11-11 12:06:31,109Z - INFO -   te_stock_market_united_kingdom: acc=0.667 (4/6) avg_delta=-0.38 avg_mag=1.25
2025-11-11 12:06:31,109Z - INFO -   te_misc_currency: acc=0.667 (4/6) avg_delta=+0.47 avg_mag=1.90
2025-11-11 12:06:31,109Z - INFO -   te_stock_market_indonesia: acc=0.667 (2/3) avg_delta=-2.73 avg_mag=2.73
2025-11-11 12:06:31,109Z - INFO -   te_stocks_united_kingdom: acc=0.667 (2/3) avg_delta=-1.83 avg_mag=1.83
2025-11-11 12:06:31,110Z - INFO - 
Bottom 10 worst performing events:
2025-11-11 12:06:31,110Z - INFO -   te_stock_market_france: acc=0.800 (4/5) avg_delta=+1.26 avg_mag=1.62
2025-11-11 12:06:31,110Z - INFO -   te_stock_market_united_states: acc=0.750 (3/4) avg_delta=-1.80 avg_mag=1.80
2025-11-11 12:06:31,110Z - INFO -   te_stock_market_germany: acc=0.750 (3/4) avg_delta=+0.82 avg_mag=2.77
2025-11-11 12:06:31,110Z - INFO -   te_stock_market_united_kingdom: acc=0.667 (4/6) avg_delta=-0.38 avg_mag=1.25
2025-11-11 12:06:31,111Z - INFO -   te_misc_currency: acc=0.667 (4/6) avg_delta=+0.47 avg_mag=1.90
2025-11-11 12:06:31,111Z - INFO -   te_stock_market_indonesia: acc=0.667 (2/3) avg_delta=-2.73 avg_mag=2.73
2025-11-11 12:06:31,111Z - INFO -   te_stocks_united_kingdom: acc=0.667 (2/3) avg_delta=-1.83 avg_mag=1.83
2025-11-11 12:06:31,111Z - INFO -   te_misc_commodity: acc=0.500 (16/32) avg_delta=-0.98 avg_mag=2.27
2025-11-11 12:06:31,111Z - INFO -   te_stock_market_china: acc=0.500 (2/4) avg_delta=+0.68 avg_mag=1.07
2025-11-11 12:06:31,111Z - INFO -   te_stock_market_italy: acc=0.400 (2/5) avg_delta=-1.12 avg_mag=2.40
2025-11-11 12:06:32,918Z - INFO - GridSearch XGBRegressor (magnitude)...
2025-11-11 12:07:07,052Z - INFO - Best XGBReg params: {'learning_rate': 0.05, 'max_depth': 6, 'n_estimators': 200}
2025-11-11 12:07:07,073Z - INFO - RMSE magnitude (pips) @+15m: 2.9173
2025-11-11 12:07:07,087Z - INFO - ==== TE V5 Trainer done ====
