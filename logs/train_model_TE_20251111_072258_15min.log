2025-11-11 09:22:58,070Z - INFO - ==== TE V5 Trainer start ====
2025-11-11 09:22:58,071Z - INFO - Connecting DB...
2025-11-11 09:22:58,133Z - INFO - DB OK
2025-11-11 09:22:58,133Z - INFO - Loading prices...
2025-11-11 09:25:12,980Z - INFO - Indicators (RSI/SMA/ATR)...
2025-11-11 09:25:16,930Z - INFO - Daily trends (SMA/trend)...
2025-11-11 09:25:18,657Z - INFO - Loading TE news...
2025-11-11 09:25:21,891Z - INFO - Filtered news piles >20: 9449 removed
2025-11-11 09:25:21,891Z - INFO - Loading imp_cache_tradingeconomics...
2025-11-11 09:25:22,197Z - INFO - Building targets (direction/magnitude) with +15m horizon...
2025-11-11 09:25:24,340Z - INFO - Dynamic horizon filter: 1395 -> 730 events (removed 665 with horizon < 5m)
2025-11-11 09:25:24,865Z - INFO - Direction classification thresholds: min=1.2, coeff=0.55
2025-11-11 09:25:24,865Z - INFO - Threshold range: [1.20, 1.87] pips, median=1.20
2025-11-11 09:25:24,865Z - INFO - Building features...
2025-11-11 09:25:24,876Z - INFO - Loading correlation features...
2025-11-11 09:25:24,920Z - INFO - Falling back to correlation_trends (currency/year).
2025-11-11 09:25:24,946Z - INFO - Applied currency/year correlation fallback.
2025-11-11 09:25:25,996Z - INFO - Time split @ 2025-11-10 08:04:24.800000+00:00: train=584, test=146
2025-11-11 09:25:25,996Z - INFO - Class balance (train): Counter({np.int64(1): 278, np.int64(2): 172, np.int64(0): 134})
2025-11-11 09:25:25,996Z - INFO - Class balance (test): Counter({np.int64(0): 55, np.int64(1): 54, np.int64(2): 37})
2025-11-11 09:25:25,997Z - INFO - Baseline (majority=1) acc=0.3699
2025-11-11 09:25:25,997Z - INFO - Train RandomForest (direction)...
2025-11-11 09:25:27,621Z - INFO - GridSearch XGBClassifier (direction)...
2025-11-11 09:25:54,837Z - INFO - Best XGB params: {'learning_rate': 0.05, 'max_depth': 4, 'n_estimators': 200}
2025-11-11 09:25:54,981Z - INFO - 
Confusion matrix [rows=true (0,1,2), cols=pred]:
[[ 0 55  0]
 [ 3 51  0]
 [ 2 35  0]]
2025-11-11 09:25:55,141Z - INFO - 
              precision    recall  f1-score   support

           0      0.000     0.000     0.000        55
           1      0.362     0.944     0.523        54
           2      0.000     0.000     0.000        37

    accuracy                          0.349       146
   macro avg      0.121     0.315     0.174       146
weighted avg      0.134     0.349     0.193       146

2025-11-11 09:25:55,145Z - INFO - Ensemble (RF+XGB) direction: acc=0.3493 f1=0.1744
2025-11-11 09:25:55,145Z - INFO - 
=== Confidence-based filtering ===
2025-11-11 09:25:55,150Z - INFO - Conf>=0.50: coverage=95.89% n=140 acc=0.357 f1=0.175
2025-11-11 09:25:55,154Z - INFO - Conf>=0.55: coverage=92.47% n=135 acc=0.363 f1=0.178
2025-11-11 09:25:55,159Z - INFO - Conf>=0.60: coverage=84.25% n=123 acc=0.382 f1=0.184
2025-11-11 09:25:55,163Z - INFO - Conf>=0.65: coverage=73.97% n=108 acc=0.417 f1=0.196
2025-11-11 09:25:55,167Z - INFO - Conf>=0.70: coverage=68.49% n=100 acc=0.430 f1=0.200
2025-11-11 09:25:55,171Z - INFO - Conf>=0.75: coverage=57.53% n= 84 acc=0.452 f1=0.208
2025-11-11 09:25:55,175Z - INFO - Class-thresholds {0: 0.55, 1: 0.62, 2: 0.55}: coverage=80.14% n=117 acc=0.385 f1=0.185
2025-11-11 09:25:55,178Z - INFO - Class-thresholds {0: 0.6, 1: 0.64, 2: 0.58}: coverage=76.03% n=111 acc=0.405 f1=0.192
2025-11-11 09:25:55,178Z - INFO - 
=== Performance by event type (top 10) ===
2025-11-11 09:25:55,190Z - INFO - 
Top 10 best performing events:
2025-11-11 09:25:55,191Z - INFO -   te_stock_market_france: acc=0.750 (3/4) avg_delta=+1.62 avg_mag=1.98
2025-11-11 09:25:55,191Z - INFO -   te_misc_commodity: acc=0.556 (15/27) avg_delta=-1.36 avg_mag=2.19
2025-11-11 09:25:55,191Z - INFO -   te_stock_market_united_kingdom: acc=0.500 (2/4) avg_delta=+0.28 avg_mag=1.02
2025-11-11 09:25:55,191Z - INFO -   te_stock_market_united_states: acc=0.500 (2/4) avg_delta=-1.80 avg_mag=1.80
2025-11-11 09:25:55,191Z - INFO -   te_misc_currency: acc=0.400 (2/5) avg_delta=-1.02 avg_mag=1.46
2025-11-11 09:25:55,191Z - INFO -   te_stock_market_euro_area: acc=0.333 (1/3) avg_delta=-4.67 avg_mag=4.67
2025-11-11 09:25:55,192Z - INFO -   te_stock_market_italy: acc=0.333 (1/3) avg_delta=-0.20 avg_mag=2.33
2025-11-11 09:25:55,192Z - INFO -   te_stock_market_japan: acc=0.000 (0/3) avg_delta=-4.73 avg_mag=4.73
2025-11-11 09:25:55,192Z - INFO - 
Bottom 10 worst performing events:
2025-11-11 09:25:55,192Z - INFO -   te_stock_market_france: acc=0.750 (3/4) avg_delta=+1.62 avg_mag=1.98
2025-11-11 09:25:55,192Z - INFO -   te_misc_commodity: acc=0.556 (15/27) avg_delta=-1.36 avg_mag=2.19
2025-11-11 09:25:55,193Z - INFO -   te_stock_market_united_kingdom: acc=0.500 (2/4) avg_delta=+0.28 avg_mag=1.02
2025-11-11 09:25:55,193Z - INFO -   te_stock_market_united_states: acc=0.500 (2/4) avg_delta=-1.80 avg_mag=1.80
2025-11-11 09:25:55,193Z - INFO -   te_misc_currency: acc=0.400 (2/5) avg_delta=-1.02 avg_mag=1.46
2025-11-11 09:25:55,193Z - INFO -   te_stock_market_euro_area: acc=0.333 (1/3) avg_delta=-4.67 avg_mag=4.67
2025-11-11 09:25:55,193Z - INFO -   te_stock_market_italy: acc=0.333 (1/3) avg_delta=-0.20 avg_mag=2.33
2025-11-11 09:25:55,194Z - INFO -   te_stock_market_japan: acc=0.000 (0/3) avg_delta=-4.73 avg_mag=4.73
2025-11-11 09:25:55,379Z - INFO - GridSearch XGBRegressor (magnitude)...
2025-11-11 09:25:57,655Z - INFO - Best XGBReg params: {'learning_rate': 0.05, 'max_depth': 4, 'n_estimators': 400}
2025-11-11 09:25:57,662Z - INFO - RMSE magnitude (pips) @+15m: 4.6873
2025-11-11 09:25:57,671Z - INFO - ==== TE V5 Trainer done ====
